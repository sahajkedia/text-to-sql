[
  {
    "question": "Show me all customers who signed up this month",
    "sql": "SELECT * FROM customers WHERE created_at >= date_trunc('month', CURRENT_DATE) ORDER BY created_at DESC;"
  },
  {
    "question": "What are the top 10 products by revenue?",
    "sql": "SELECT p.name, SUM(oi.quantity * oi.unit_price) as total_revenue FROM products p JOIN order_items oi ON p.id = oi.product_id GROUP BY p.id, p.name ORDER BY total_revenue DESC LIMIT 10;"
  },
  {
    "question": "How many orders were placed last week?",
    "sql": "SELECT COUNT(*) as order_count FROM orders WHERE created_at >= CURRENT_DATE - INTERVAL '7 days';"
  },
  {
    "question": "List customers who haven't placed an order in 90 days",
    "sql": "SELECT c.* FROM customers c LEFT JOIN orders o ON c.id = o.customer_id AND o.created_at >= CURRENT_DATE - INTERVAL '90 days' WHERE o.id IS NULL;"
  },
  {
    "question": "Show monthly revenue trends for the past year",
    "sql": "SELECT date_trunc('month', o.created_at) as month, SUM(o.total_amount) as revenue FROM orders o WHERE o.created_at >= CURRENT_DATE - INTERVAL '1 year' GROUP BY date_trunc('month', o.created_at) ORDER BY month;"
  },
  {
    "question": "Which employees have processed the most orders?",
    "sql": "SELECT e.name, COUNT(o.id) as orders_processed FROM employees e JOIN orders o ON e.id = o.processed_by GROUP BY e.id, e.name ORDER BY orders_processed DESC LIMIT 10;"
  },
  {
    "question": "Show me the average order value by customer segment",
    "sql": "SELECT c.segment, AVG(o.total_amount) as avg_order_value FROM customers c JOIN orders o ON c.id = o.customer_id GROUP BY c.segment ORDER BY avg_order_value DESC;"
  },
  {
    "question": "Find duplicate email addresses in the users table",
    "sql": "SELECT email, COUNT(*) as count FROM users GROUP BY email HAVING COUNT(*) > 1 ORDER BY count DESC;"
  },
  {
    "question": "What's the conversion rate from cart to purchase?",
    "sql": "SELECT ROUND(100.0 * COUNT(DISTINCT o.cart_id) / COUNT(DISTINCT c.id), 2) as conversion_rate FROM carts c LEFT JOIN orders o ON c.id = o.cart_id WHERE c.created_at >= CURRENT_DATE - INTERVAL '30 days';"
  },
  {
    "question": "Show inventory items that are running low",
    "sql": "SELECT p.name, i.quantity, i.reorder_level FROM inventory i JOIN products p ON i.product_id = p.id WHERE i.quantity <= i.reorder_level ORDER BY (i.quantity::float / NULLIF(i.reorder_level, 0)) ASC;"
  }
]

